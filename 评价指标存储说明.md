# TITS -v6.0 评价指标存储位置与形式说明

根据`评价指标.md`中定义的关键评价指标，本文档详细说明这些指标在项目中的具体存储位置、格式和获取方式。

## 1. 主要评价指标及存储位置

### 1.1 长期平均系统成本 (Overall Long-Term Average Cost)

**存储位置：**
- **主要位置：** 各求解器的`summary.json`文件中的`"C_mean"`字段
- **具体路径示例：**
  - `logs/summary.json` - 整体汇总结果
  - `test_results/[求解器名称]_run_1/summary.json` - 单个求解器测试结果
  - `test_results/[求解器名称]_summary.json` - 求解器全局汇总结果

**数据类型：** 浮点数 (float)

**示例：**
```json
"C_mean": 0.821648354554072
```

### 1.2 平均端到端时延 (Average End-to-End Delay)

**存储位置：**
- **主要位置：** 各求解器的`summary.json`文件中的`"avg_delay_mean"`字段
- **具体路径示例：** 与长期平均系统成本相同

**数据类型：** 浮点数 (float)

**示例：**
```json
"avg_delay_mean": 0.8701811573036433
```

### 1.3 队列稳定性 (Queue Stability)

**存储位置：**
- **主要位置：** 各求解器的`summary.json`文件中的`"Avg_queue"`字段
- **具体路径示例：** 与长期平均系统成本相同

**数据类型：** 浮点数 (float)

**示例：**
```json
"Avg_queue": 0.0
```

### 1.4 单时隙决策时延 (Decision Time per Slot)

**存储位置：**
- **总体统计：** 各求解器的`summary.json`文件中的`"DecisionTime_ms_mean"`字段
- **详细数据：** 各求解器的`per_slot_minimal.csv`文件中的`solve_time_s`列
- **具体路径示例：**
  - `test_results/[求解器名称]_run_1/solvers_[求解器名称]_[求解器名称]/per_slot_minimal.csv`

**数据类型：**
- 浮点数 (float)
- `DecisionTime_ms_mean`以毫秒为单位
- `solve_time_s`以秒为单位

**示例：**
```json
"DecisionTime_ms_mean": 74.99771118164062
```

CSV数据示例：
```csv
solve_time_s
0.06905889511108398
0.09007549285888672
0.08199906349182129
```

## 2. 成本-时延权衡曲线数据

**存储位置：**
- **主要数据源：** `logs/sensitivity_results.csv`
- **可视化结果：** `plots/sensitivity/sensitivity_V.png`

**数据形式：**
- CSV格式，包含不同V值下的系统成本和时延数据
- 横轴为控制参数V，纵轴分别为系统成本(C_mean)和平均时延(avg_delay_mean)

## 3. 各求解器的结果结构

### 3.1 logs目录结果结构

```
logs/
├── summary.json                 # 所有求解器的综合结果
├── sensitivity_results.csv      # 敏感性分析结果（包括成本-时延权衡数据）
├── experiment_metrics.txt       # 实验指标汇总
├── solvers_[求解器名称]_[求解器名称]/
│   ├── [求解器名称]_output.txt    # 求解器输出日志
│   ├── per_slot_minimal.csv      # 每个时间槽的详细数据
│   └── summary.json              # 该求解器的性能摘要
```

### 3.2 test_results目录结果结构

```
test_results/
├── [求解器名称]_run_1/                 # 单个求解器的运行结果
│   ├── summary.json                   # 求解器运行结果摘要
│   ├── experiment_config.json         # 实验配置
│   ├── experiment_log.txt             # 实验日志
│   └── solvers_[求解器名称]_[求解器名称]/
│       ├── [求解器名称]_output.txt        # 求解器输出
│       ├── per_slot_minimal.csv        # 每个时间槽的详细数据
│       └── summary.json                # 求解器详细摘要
├── [求解器名称]_summary.json          # 求解器全局汇总文件
└── experiment_config.json             # 整体实验配置
```

## 4. per_slot_minimal.csv 文件格式详解

`per_slot_minimal.csv`文件包含每个时间槽的详细运行数据，是计算各种平均指标的基础数据来源：

**主要字段说明：**
- `slot`: 时间槽编号
- `arrival_tasks`: 到达的任务数
- `completed_tasks`: 完成的任务数
- `dropped_tasks`: 丢弃的任务数
- `effective_bits`: 有效处理的数据比特数
- `energy_srv`: 服务器能耗
- `energy_tx`: 传输能耗
- `queue_mean`: 平均队列长度（用于计算队列稳定性）
- `solve_time_s`: 单时隙决策时间（秒）
- `total_cost`: 当前时间槽的总成本（用于计算长期平均系统成本）

## 5. 数据获取方式

### 5.1 直接读取结果文件

可以通过读取对应的JSON和CSV文件直接获取指标数据：

```python
import json
import pandas as pd

# 读取summary.json获取平均指标
def get_summary_metrics(summary_path):
    with open(summary_path, 'r', encoding='utf-8') as f:
        data = json.load(f)
    return {
        '长期平均系统成本': data['C_mean'],
        '平均端到端时延': data['avg_delay_mean'],
        '平均队列长度': data['Avg_queue'],
        '平均决策时间(ms)': data['DecisionTime_ms_mean']
    }

# 读取per_slot_minimal.csv获取详细时间槽数据
def get_slot_data(csv_path):
    return pd.read_csv(csv_path)
```

### 5.2 使用run_plot.py生成可视化结果

项目提供的`run_plot.py`脚本可以直接读取结果数据并生成可视化图表，包括成本-时延权衡曲线。

```bash
python run_plot.py --sensitivity V
```

## 6. 生成成本-时延权衡曲线的方法

要生成成本-时延权衡曲线，需要：

1. 运行多次实验，每次使用不同的控制参数V值
2. 收集每次实验的`C_mean`和`avg_delay_mean`值
3. 以V值为横轴，以成本和时延为双纵轴绘制曲线

相关数据存储在`logs/sensitivity_results.csv`中，可视化结果存储在`plots/sensitivity/sensitivity_V.png`中。